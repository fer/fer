# Module 05: Vulnerability Analysis

{% hint style="info" %}
**Objectives**

* Overview of Vulnerability Research, Vulnerability Assessment, and Vulnerability Scoring Systems 
* Overview of Vulnerability Management Life Cycle \(Vulnerability Assessment Phases\)
* Understanding Various Types of Vulnerabilities and Vulnerability Assessment Techniques
* Understanding Different Approaches of Vulnerability Assessment Solutions
* Understanding Different Types of Vulnerability Assessment Tools and Criteria for Choosing Them
* Vulnerability Assessment Tools 
* Generating and Analyzing Vulnerability Assessment Reports
{% endhint %}

## 1. Vulnerability Assessment Concepts

* 2 main causes for vulnerable systems in a network:
  * software 
  * hardware misconfiguration and poor programming practices

### Vulnerability Research

* Vulnerability assessment, vulnerability scoring systems, vulnerability databases, and the vulnerability assessment life cycle.

**Security experts** and vulnerability scanners classify vulnerabilities by: 1. severity level \(low, medium, or high\) 2. exploit range \(local or remote\)

An **administrator** needs vulnerability research:

* To gather information about security trends, newly discovered threats, attack surfaces, attack vectors and techniques.
* To find weaknesses in the OS and applications and alert the network administrator before a network attack.
* To understand information that helps prevent security problems.
* To know how to recover from a network attack.

An **ethical hacker** needs to keep up with the most recently discovered vulnerabilities and exploits to stay one step ahead of attackers through vulnerability research, which includes:

* Discovering the system design faults and weaknesses that might allow attackers to compromise a system.
* Staying updated about new products and technologies and reading news related to current exploits.
* Checking underground hacking web sites \(Deep and Dark websites\) for newly discovered vulnerabilities and exploits.
* Checking newly released alerts regarding relevant innovations and product improvements for security systems.

#### Resources for Vulnerability Research

* [Microsoft Vulnerability Research \(MSVR\)](https://www.microsoft.com)
* [Dark Reading](https://www.darkreading.com)
* [SecurityTracker](https://securitytracker.com)
* [Trend Micro](https://www.trendmicro.com)
* [Security Magazine](https://www.securitymagazine.com)
* [PenTest Magazine](https://pentestmag.com)
* [SC Magazine](https://www.scmagazine.com)
* [Exploit Database](https://www.exploit-db.com)
* [SecurityFocus](https://www.securityfocus.com)
* [Help Net Security](https://www.helpnetsecurity.com)
* [HackerStorm](http://www.hackerstorm.co.uk)
* [Computerworld](https://www.computerworld.com)
* [WindowsSecurity](http://www.windowsecurity.com)
* [D’Crypt](https://www.d-crypt.com)

### Vulnerability assessment

* Vulnerability assessment is an in-depth examination of the ability of a system or application, including current security procedures and controls, to withstand the exploitation.
* It recognizes, measures, and classifies security vulnerabilities in a computer system, network, and communication channels.

A vulnerability assessment may be used to:

* Identify weaknesses that could be exploited.
* Predict the effectiveness of additional security measures in protecting information resources from attack.

Vulnerability-scanning software scans the computer against the Common Vulnerability and Exposures \(CVE\) index and security bulletins provided by the software vendor.

Vulnerability scanners are capable of identifying the following information:

* The OS version running on computers or devices 
* IP and Transmission Control Protocol/User Datagram Protocol \(TCP/UDP\) ports that are listening
* Applications installed on computers
* Accounts with weak passwords 
* Files and folders with weak permissions 
* Default services and applications that might have to be uninstalled 
* Errors in the security configuration of common applications 
* Computers exposed to known or publicly reported vulnerabilities 
* EOL/EOS software information 
* Missing patches and hotfixes 
* Weak network configurations and misconfigured or risky ports 
* Help to verify the inventory of all devices on the network

Vulnerability assessment can be a "false positive", unaccurate.. that's why pentesting is needed right after.

#### Limitations of Vulnerability Assessment

The following are some of the limitations of vulnerability assessments:

* Vulnerability-scanning software is limited in its ability to detect vulnerabilities at a given point in time.
* Vulnerability-scanning software must be updated when new vulnerabilities are discovered or when improvements are made to the software being used.
* Software is only as effective as the maintenance performed on it by the software vendor and by the administrator who uses it.
* Vulnerability Assessment does not measure the strength of security control.
* Vulnerability-scanning software itself is not immune to software engineering flaws that might lead to it missing serious vulnerabilities.
* Human judgment is needed to analyze the data after scanning and identifying the false positives and false negatives.

### Vulnerability scoring systems & databases

Following are some of the vulnerability scoring systems and databases:

#### Common Vulnerability Scoring System \(CVSS\)

* [https://www.first.org](https://www.first.org)
* [https://nvd.nist.gov](https://nvd.nist.gov)
* CVSS is a published standard that provides an open framework for communicating the characteristics and impacts of IT vulnerabilities.
* The system’s quantitative model ensures repeatable, accurate measurement while enabling users to see the underlying vulnerability characteristics that were used to generate the scores. 
* Two common uses of CVSS are:
  * prioritizing vulnerability remediation activities
  * calculating the severity of vulnerabilities discovered on one’s systems
* The National Vulnerability Database \(NVD\) provides CVSS scores for almost all known vulnerabilities.

CVSS assessment consists of three metrics for measuring vulnerabilities:

* **Base Metric**: Represents the inherent qualities of a vulnerability.
* **Temporal Metric**: Represents the features that continue to change during the lifetime of the vulnerability.
* **Environmental Metric**: Represents vulnerabilities that are based on a particular environment or implementation.

CVSS v3.0 ratings:

| Severity | Base Score Range |
| :--- | :--- |
| None | 0.0 |
| Low | 0.1-3.9 |
| Medium | 4.0-6.9 |
| High | 7.0-8.9 |
| Critical | 9.0-10.0 |

CVSS v2.0 ratings:

| Severity | Base Score Range |
| :--- | :--- |
| Low | 0.0-3.9 |
| Medium | 4.0-6.9 |
| High | 7.0-10 |

#### Common Vulnerabilities and Exposures \(CVE\)

* [https://cve.mitre.org](https://cve.mitre.org)
* CVE is a publicly available and free-to-use list or dictionary of standardized identifiers for common software vulnerabilities and exposures.
* CVE provides a baseline for tool evaluation and enables data exchange for cybersecurity automation. 
* CVE IDs provide a baseline for evaluating the coverage of tools and services so that users can determine which tools are most effective and appropriate for their organization’s needs.

What CVE is:

* One identifier for one vulnerability or exposure 
* One standardized description for each vulnerability or exposure 
* A dictionary rather than a database 
* A method for disparate databases and tools to “speak” the same language 
* The way to interoperability and better security coverage 
* A basis for evaluation among services, tools, and databases 
* Free for the public to download and use
* Industry-endorsed via the CVE Numbering Authorities, CVE Board, and the numerous products and services that include CVE

#### National Vulnerability Database \(NVD\)

* [https://nvd.nist.gov](https://nvd.nist.gov)
* The NVD is the U.S. government repository of standards-based vulnerability management data. 
* It uses the Security Content Automation Protocol \(SCAP\).
* The NVD performs an analysis on CVEs that have been published to the CVE Dictionary.
* NVD staff are tasked with the analysis of CVEs by aggregating data points from the description, references supplied, and any supplemental data that are publicly available. 
* This analysis results in association impact metrics \(Common Vulnerability Scoring System – CVSS\), vulnerability types \(Common Weakness Enumeration — CWE\), and applicability statements \(Common Platform Enumeration — CPE\), as well as other pertinent metadata.
* The NVD does not actively perform vulnerability testing.

#### Common Weakness Enumeration \(CWE\)

* [https://cwe.mitre.org](https://cwe.mitre.org)
* Common Weakness Enumeration \(CWE\) is a category system for software vulnerabilities and weaknesses.
* It is sponsored by the National Cybersecurity FFRDC, which is owned by The MITRE Corporation, with support from US-CERT and the National Cyber Security Division of the U.S.

### Vulnerability assessment life cycle

1. Identify Assets and Create a Baseline
   * This phase identifies critical assets and prioritizes them to define the risk based on the criticality and value of each system. This creates a good baseline for vulnerability management. This phase involves the gathering of information about the identified systems to understand the approved ports, software, drivers, and basic configuration of each system in order to develop and maintain a system baseline.
   * Tasks:
     * Identify and understand business processes.
     * Identify the applications, data, and services that support the business processes and perform code reviews
     * Identify the approved software, drivers, and basic configuration of each system 
     * Create an inventory of all assets, and prioritize or rank the critical assets 
     * Understand the network architecture and map the network infrastructure 
     * Identify the controls already in place 
     * Understand policy implementation and practice standard compliance with business processes
     * Define the scope of the assessment 
     * Create information protection procedures to support effective planning, scheduling, coordination, and logistics
2. Vulnerability Scan
   * This phase is very crucial in vulnerability management. In this step, the security analyst performs the vulnerability scan on the network to identify the known vulnerabilities in the organization’s infrastructure. Vulnerability scans can also be performed on applicable compliance templates to assess the organization’s Infrastructure weaknesses against the respective compliance guidelines.
   * Task:
     * Examine and evaluate the physical security 
       * Check for misconfigurations and human errors 
       * Run vulnerability scans using tools 
       * Select the type of scan based on the organization or compliance requirements 
       * Identify and prioritize vulnerabilities 
       * Identify false positives and false negatives 
       * Apply the business and technology context to scanner results 
       * Perform OSINT information gathering to validate the vulnerabilities 
       * Create a vulnerability scan report
   * Post Assessment Phase: The post-assessment phase, also known as the recommendation phase, is performed after and based on risk assessment. Risk characterization is categorized by key criteria, which helps prioritize the list of recommendations.
     * Tasks:         
       * Creating a priority list for assessment recommendations based on the impact analysis 
       * Developing an action plan to implement the proposed remediation 
       * Capturing lessons learned to improve the complete process in the future 
       * Conducting training for employee
3. Risk Assessment
   * In this phase, all serious uncertainties that are associated with the system are assessed and prioritized, and remediation is planned to permanently eliminate system flaws. The risk assessment summarizes the vulnerability and risk level identified for each of the selected assets. It determines whether the risk level for a particular asset is high, moderate, or low. Remediation is planned based on the determined risk level. For example, vulnerabilities ranked high-risk are targeted first to decrease the chances of exploitation that would adversely impact the organization.
   * Tasks:
     * Perform risk categorization based on risk ranking \(for example, critical, high, medium, and low\)
     * Assess the level of impact 
     * Determine the threat and risk level
4. Remediation 
   * Remediation is the process of applying fixes on vulnerable systems in order to reduce the impact and severity of vulnerabilities. This phase is initiated after the successful implementation of the baseline and assessment steps.
   * Tasks
     * Prioritize remediation based on the risk ranking 
     * Develop an action plan to implement the recommendation or remediation 
     * Perform a root-cause analysis 
     * Apply patches and fixes 
     * Capture lessons learned 
     * Conduct awareness training
     * Perform exception handling and risk acceptance for the vulnerabilities that cannot be remediated
5. Verification
   * In this phase, the security team performs a re-scan of systems to assess if the required remediation is complete and whether the individual fixes have been applied to the impacted assets. This phase provides clear visibility into the firm and allows the security team to check whether all the previous phases have been perfectly employed or not. Verification can be performed by using various means such as ticketing systems, scanners, and reports.
6. Monitor
   * Organizations need to performed regular monitoring to maintain system security. They use tools such as IDS/IPS and firewalls. Continuous monitoring identifies potential threats and any new vulnerabilities that have evolved. As per security best practices, all phases of vulnerability management must be performed regularly.
7. Back to 1

## 2. Vulnerability Classification and Assessment Types

### Classification

1. Misconfiguration
   * An application running with debug enabled 
   * Unnecessary administrative ports that are open for an application 
   * Running outdated software on the system 
   * Running unnecessary services on a machine 
   * Outbound connections to various Internet services 
   * Using misconfigured SSL certificates or default certificates 
   * Improperly authenticated external systems 
   * Incorrect folder permissions 
   * Default accounts or passwords 
   * Set up or configuration pages enabled 
   * Disabling security settings and features
2. Default Installations 
   * Default installations are usually user-friendly — especially when the device is being used for the first time when the primary concern is the usability of the device rather than the device’s security. In some cases, infected devices may not contain any valuable information, but are connected to networks or systems that have confidential information that would result in a data breach. Failing to change the default settings while deploying the software or hardware allows the attacker to guess the settings to break into the system.
3. Buffer Overflows
   * Buffer overflows are common software vulnerabilities that happen due to coding errors that allow attackers to gain access to the target system. In a buffer overflow attack, the attackers undermine the functioning of programs and try to take control of the system by writing content beyond the allocated size of the buffer. Insufficient bounds checking in the program is the root cause. The buffer is not able to handle data beyond its limit, causing the flow of data to adjacent memory locations and overwriting their data values. Systems often crash, become unstable, or show erratic program behavior when buffer overflow occurs.
4. Unpatched Servers 
   * Servers are an essential component of the infrastructure of any organization. There are several cases where organizations run unpatched and misconfigured servers that compromise the security and integrity of the data in their system. Hackers look out for these vulnerabilities in the servers and exploit them. As these unpatched servers are a hub for the attackers, they serve as an entry point into the network. This can lead to the exposure of private data, financial loss, and discontinuation of operations. Updating software regularly and maintaining systems properly by patching and fixing bugs can help in mitigating the vulnerabilities caused by unpatched servers.
5. Design Flaws
   * Vulnerabilities due to design flaws are universal to all operating devices and systems. Design vulnerabilities such as incorrect encryption or the poor validation of data refer to logical flaws in the functionality of the system that attackers exploit to bypass the detection mechanism and acquire access to a secure system.
6. Operating System Flaws
   * Due to vulnerabilities in the operating systems, applications such as trojans, worms, and viruses pose threats. These attacks use malicious code, script, or unwanted software, which results in the loss of sensitive information and control of computer operations.
7. Application Flaws 
   * Application flaws are vulnerabilities in applications that are exploited by the attackers. Applications should be secured using the validation and authorization of the user. Flawed applications pose security threats such as data tampering and unauthorized access to configuration stores. If the applications are not secured, sensitive information may be lost or corrupted.
8. Open Services 
   * Open ports and services may lead to the loss of data or DoS attacks and allow attackers to perform further attacks on other connected devices. Administrators must continuously check for unnecessary or insecure ports and services to reduce the risk to the network.
9. Default Passwords 
   * Manufacturers provide users with default passwords to access the device during its initial set-up, which users must change for future use. When users forget to update the passwords and continue using the default passwords, they make devices and systems vulnerable to various attacks, such as brute force and dictionary attacks. Attackers exploit this vulnerability to obtain access to the system. Passwords should be kept confidential; failing to protect the confidentiality of a password allows the system to be easily compromised.

### Types

* **Active Assessment**: Uses a network scanner to find hosts, services, and vulnerabilities.
* **External Assessment**: Assesses the network from a hacker's perspective to discover exploits and vulnerabilities that are accessible to the outside world.
  * Determine a set of rules for firewall and router configurations for the external network
  * Check whether the external server devices and network devices are mapped 
  * Identify open ports and related services on the external network 
  * Examine the patch levels on the server and external network devices 
  * Review detection systems such as IDS, firewalls, and application-layer protection systems
  * Get information on DNS zones
  * Scan the external network through a variety of proprietary tools available on the Internet
  * Examine Web applications such as e-commerce and shopping cart software for vulnerabilities
* **Host-based Assessment**: Conducts a configuration-level check to identify system configurations, user directories, file systems, registry settings, etc., to evaluate the possibility of compromise.
* **Application Assessment**: Tests and analyzes all elements of the web infrastructure for any misconfiguration, outdated content, or known vulnerabilities.
* **Passive Assessment**: Used to sniff the network traffic to discover present active systems, network services, applications, and vulnerabilities present.
* **Internal Assessment**: Scans the internal infrastructure to discover exploits and vulnerabilities.
  * Specify the open ports and related services on network devices, servers, and systems
  * Check the router configurations and firewall rule sets 
  * List the internal vulnerabilities of the operating system and server 
  * Scan for any trojans that may be present in the internal environment 
  * Check the patch levels on the organization’s internal network devices, servers, and systems
  * Check for the existence of malware, spyware, and virus activity and document them 
  * Evaluate the physical security
  * Identify and review the remote management process and events 
  * Assess the file-sharing mechanisms \(for example, NFS and SMB/CIFS shares\) 
  * Examine the antivirus implementation and events
* **Network-based Assessment**: Determines possible network security attacks that may occur on the organization’s system.
  * Checks the network topologies for inappropriate firewall configuration 
  * Examines the router filtering rules 
  * Identifies inappropriately configured database servers 
  * Tests individual services and protocols such as HTTP, SNMP, and FTP 
  * Reviews HTML source code for unnecessary information 
  * Performs bounds checking on variables
* **Database Assessment**: Focuses on testing databases, such as MYSQL, MSSQL, ORACLE, POSTGRESQL, etc., for the presence of data exposure or injection type vulnerabilities.
* **Wireless Network Assessment**: Determinesthe vulnerabilities in the organization’s wireless networks.
* **Distributed Assessment**: Assesses the distributed organization assets, such as client and server applications, simultaneously through appropriate synchronization techniques
* **Credentialed Assessment**: Assesses the network by obtaining the credentials of all machines present in the network.
* **Non-Credentialed Assessment**: Assesses the network without acquiring any credentials of the assets present in the enterprise network.
* **Manual Assessment**: In this type of assessment, the ethical hacker manually assesses the vulnerabilities, vulnerability ranking, vulnerability score, etc.
* **Automated Assessment**: In this type of assessment, the ethical hacker employs various vulnerability assessment tools, such as Nessus, Qualys, GFI LanGuard, etc.

## 3. Vulnerability Assessment Solutions and Tools

Network vulnerability scanners help to analyze and identify vulnerabilities in the target network or network resources by using vulnerability assessment and network auditing. These tools also assist in overcoming weaknesses in the network by suggesting various remediation techniques.

* [Qualys Vulnerability Management](https://www.qualys.com)
* [Nessus Professional](https://www.tenable.com)
* \[GFI LanGuard Source\]
* [OpenVAS](http://www.openvas.org)
* [Nikto](https://cirt.net)
* [Qualys FreeScan](https://freescan.qualys.com)
* [Acunetix Web Vulnerability Scanner](https://www.acunetix.com)
* [Nexpose](https://www.rapid7.com)
* [Microsoft Baseline Security Analyzer \(MBSA\)](https://www.microsoft.com)
* [beSECURE \(AVDS\)](https://www.beyondsecurity.com)
* [Core Impact Pro](https://www.coresecurity.com)
* [Network Security Scanner](https://www.beyondtrust.com)
* [N-Stalker Web Application Security Scanner](https://www.nstalker.com)
* [SAINT](https://www.saintcorporation.com)
* [Manager Plus ManageEngine Vulnerability](https://www.manageengine.com)

### For Mobile

* [Vulners Scanner](https://vulners.com)
* \[SecurityMetrics Mobile\]

## 4. Vulnerability Assessment Reports

* The vulnerability assessment report discloses the risks detected after scanning a network 
* The report alerts the organization of possible attacks and suggests countermeasures 
* Information available in the reports is used to fix security flaws

Vulnerability Assessment Report:

* Scan Information 
* Target Information 
* Results

The vulnerability assessment report must include, but are not limited to, the following points:

* The vulnerability's name and its mapped CVE ID
* The date of discovery
* The score based on Common Vulnerabilities and Exposures \(CVE\) databases
* A detailed description of the vulnerability
* The impact of the vulnerability
* Details regarding the affected systems
* Details regarding the process needed to correct the vulnerability, including information patches, configuration fixes, and ports to be blocked.
* A proof of concept \(PoC\) of the vulnerability for the system \(if possible\) 

## Module Summary

In this module, we have discussed:

* The definition of vulnerability research, vulnerability assessment, and vulnerability-management life cycle
* The CVSS vulnerability scoring system and databases 
* Various types of vulnerabilities and vulnerability assessment techniques 
* Various vulnerability assessment solutions, along with their characteristics
* Various tools that are used to test a host or application for vulnerabilities, along with the criteria and best practices for selecting the tool
* We concluded with a detailed discussion on how to analyze a vulnerability assessment report and how it discloses the risks detected after scanning the network

In the next module, we will discuss the methods attackers, as well as ethical hackers and pen testers, utilize to hack a system based on the information collected about a target of evaluation; for example, footprinting, scanning, enumeration, and vulnerability analysis phases

\[SecurityMetrics Mobile\]: [https://www.securitymetrics.com](https://www.securitymetrics.com) "SecurityMetrics Mobile is a mobile defense tool that helps to identify mobile device vulnerabilities to protect customers’ sensitive data. It helps to avoid threats that originate from mobile malware, device theft, Wi-Fi network connectivity, data entry, personal and business use, unwarranted app privileges, data and device storage, account data access, Bluetooth, Infrared \(IR\), Near-field communication \(NFC\), and SIM and SD cards."

