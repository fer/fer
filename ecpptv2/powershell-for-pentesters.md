---
description: >-
  PowerShell is a powerful built-in shell and scripting environment we can
  utilize as penetration testers considering its wide-spread availability on all
  modern Windows based systems.
---

# PowerShell for Pentesters

{% hint style="danger" %}
**This document is still in progress...** 
{% endhint %}

## Introduction

### Why PowerShell - Study Guide

Powershell is a powerful built-in shell and scripting environment we can utilize as penetration testers considering its wide-spread availability on all modern Windows-based systems.

The use of Powershell allows us to take advantage of the "living-off-the-land" concept, where using tools that are built-in to the OS work to our advantage once we've obtained access to a system.

There are many advantages to using Powershell as it relates to penetration testing with some of them being:

* Many organizations aren't actively hunting for Powershell activity since it is usually considered a "trusted" application.
* We can use Powershell to run, download or execute code, entirely within the memory process of the Powershell executable, helping us evade endpoint security solutions.
* We can use it to interface with the .NET and other Windows APIs.
* We can call Windows DLL unctions from within Powershell.
* We can use it to bypass application whitelisting implementations by running the usual OS commands from from the Powershell CLI.
* Many tools are already available to us for a large amount of purposes related to penetration testing.
* Having access to all of those things through Powershell helps us reduce our footprint and evade defense mechanisms while conducting post-exploitation tasks.
* Powershell is also easy to use, and there are many scripts and frameworks written that we can utilize for our offensive purposes.
* Furthermore, it doesn't take much to create our own scripts to carry out some of our tasks as we'll see in the modules that follow.

{% embed url="https://www.secureworks.com/blog/living-off-the-land" %}

{% embed url="https://github.com/PowerShellMafia/PowerSploit" %}

{% embed url="https://en.wikipedia.org/wiki/PowerShell" %}

### What is PowerShell - Study Guide

Powershell is a powerful built-in Command Line Interpreter or "shell", and task-oriented scripting language environment found on most current Windows Operating Systems starting with Windows 7 and through to Windows 2008 R2 and onward.

Powershell is typically used by administrators as it provides great functionality and flexibility in regards to managing Windows systems and automating tasks, which is mostly the reason why it's the perfect tool when it comes to our process as penetration testers.

Powershell is tightly integrated with the .NET framework, and it's built on top of it.

It also provides convenient access to the .NET Framework API, Component Object Model \(COM\) and Windows Management Instrumentation \(WMI\) which is another plus in regards to persistence methods and ways we can gather information.

Most of the time, we'll either be working with scripts commonly identified by the `.ps1` file extension, or through what are known as "Cmdlets" \(native Powershell commands\) of which we can also create our own, and other times, we'll be interacting directly with via the Powershell CLI.

{% embed url="https://docs.microsoft.com/en-us/powershell/scripting/developer/cmdlet/cmdlet-overview?view=powershell-7" %}

An important point to note as we navigate through the upcoming topics is that more recent versions of Powershell, specifically 5.0 and onward, introduce some potential hurdles in regards to detection, loggin and more restrictive modes.

{% embed url="https://en.wikipedia.org/wiki/PowerShell\#Versions" %}

{% embed url="https://devblogs.microsoft.com/powershell/powershell-constrained-language-mode/" %}

{% embed url="https://www.crowdstrike.com/blog/investigating-powershell-command-and-script-logging/" %}

In 2016, Powershell 6.0 \(Powershell Core\) was made available for several different platforms, including some major Linux distributions, MacOS and also as a Docker container image:

{% embed url="https://github.com/powershell/powershell" %}

{% embed url="https://docs.microsoft.com/en-us/powershell/scripting/developer/cmdlet/cmdlet-overview?view=powershell-7" %}

{% embed url="https://en.wikipedia.org/wiki/Command-line\_interface\#Command-line\_interpreter" %}

{% embed url="https://en.wikipedia.org/wiki/Component\_Object\_Model" %}

{% embed url="https://www.crowdstrike.com/blog/investigating-powershell-command-and-script-logging/" %}

{% embed url="https://devblogs.microsoft.com/powershell/powershell-core-6-0-generally-available-ga-and-supported/" %}

{% embed url="https://en.wikipedia.org/wiki/Windows\_Management\_Instrumentation" %}

## PowerShell Fundamentals

### The PowerShell CLI - Study Guide

### Cmdlets - Study Guide

### Modules - Study Guide

### Scripts - Study Guide

### Objects - Study Guide

## Offensive PowerShell

### Downloading and Execution - Study Guide

### Obfuscation - Study Guide

### Information Gathering and Recon - Study Guide

### Post-Exploitation with PowerShell - Study Guide

### PowerShell and Metasploit

### â–¶ Empire Overview

### â–¶ UAC Bypass PowerShell Exploit Script Walkthrough

### â–¶ Introduction to Leveraging WMI and Methods for Persistence

### ðŸ§ª Leveraging PowerShell During Exploitation

### ðŸ§ª PowerShell for Post-exploitation and Lateral Movement



